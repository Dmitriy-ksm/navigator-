Собственно попытка улучшить алгоритм, путем хеширования очередей, которая увенчалась полным провалом 
